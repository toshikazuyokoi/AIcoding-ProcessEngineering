# 品質ゲート: 実装計画品質チェック

## 目的・スコープ

STEP 5（実装計画）完了時に、計画の完全性・一貫性・実現可能性・自動化準備状況を確認し、STEP 7（コーディング実行）へ移行して良いかを判定する。過不足や非現実的な計画のまま実装へ進むことを防止する。

## Source Mapping
- @docs-theory/theory/ai-coding-development-process-v1.3-deliverable-flow.md § 実装計画の成果物
- @docs-theory/theory/process-engineering-v1.3-complete-definition.md § STEP5
- @docs-theory/theory/quality-gate-implementation-guide-v1.3.md
- @docs-theory/theory/quality-gate-detailed-specifications-v1.3.md § Implementation Planning

## チェック項目

### 1. ディレクトリ構造設計の妥当性
- [ ] 主要レイヤ構成（presentation/application/domain/infrastructure）が明示
- [ ] ファイル/モジュール配置規則と命名規則が定義
- [ ] 拡張を見据えたスケーラブルな構造（テスト/設定/環境分離）

### 2. 実装コンポーネント一覧の完全性
- [ ] 全コンポーネントにID/パス/レイヤ/依存関係/見積が付与
- [ ] 依存関係がSTEP3（詳細設計）と一致
- [ ] 優先度と実装順序が明確

### 3. 3フェーズ実装計画の整合性
- [ ] Phase1: 単体テスト中心の粒度で分割
- [ ] Phase2: 結合テスト対象と結線が明示
- [ ] Phase3: E2E対象と品質目標（性能等）が明示

### 4. 開発工程表の現実性
- [ ] タスク→成果物→品質ゲートの対応が一対一で明確
- [ ] クリティカルパスの把握とバッファ設定
- [ ] マイルストーンとレビュー日程が設定

### 5. 依存関係マップ（Mermaid等）の正確性
- [ ] 主要エンティティ/サービス/リポジトリの依存が図示
- [ ] クロスレイヤ依存の例外が説明済み
- [ ] 外部I/F・DB・キャッシュ等の境界が区別

### 6. 品質管理計画の網羅性
- [ ] 静的解析（ESLint/TypeCheck）の実行計画
- [ ] テストカバレッジ目標（行/分岐）と測定方法
- [ ] セキュリティ/性能/監視・ログの方針

### 7. STEP4（テスト設計）との整合
- [ ] 単体/結合/E2Eの設計→実装計画へのトレースが可能
- [ ] テストデータ/モック戦略が実装計画に反映
- [ ] カバレッジ目標が工程表/CIに組み込まれている

### 8. リソース/見積の妥当性
- [ ] スキル/人数/期間の整合（実現可能性）
- [ ] 見積根拠と過去実績/リスク係数の明示
- [ ] 外部コストやCIリソースの考慮

### 9. 自動化/CI準備
- [ ] npmスクリプト/ワークフロー定義（test, lint, type-check, coverage）
- [ ] カバレッジ閾値とブロック条件が設定
- [ ] 将来のCD/デプロイ連携を見据えた分離

### 10. リスク管理
- [ ] 技術・スケジュール・人員リスクの洗い出し
- [ ] 兆候/回避・低減策/バックアップ案の定義
- [ ] レビュー/エスカレーション経路の明示

## 品質基準

### 定量的基準
| 項目 | 基準値 | 測定方法 |
|------|--------|----------|
| 設計要素網羅率 | 100% | コンポーネント一覧・構造図と照合 |
| テスト目標設定率 | 100% | カバレッジ閾値・CI設定の存在確認 |
| トレーサビリティ | 100% | STEP4→STEP5の対応表 |
| 見積精度許容範囲 | ±20% | 見積根拠と実績比較（過去案件/パイロット） |
| 自動化準備 | 100% | スクリプト・CIジョブ定義の存在確認 |

### 定性的基準
- 実現可能性: 期間/スキル/環境で実行できる計画
- 保守性: 増築可能で分離のよい構造
- 一貫性: 上流（STEP3/4）との整合が取れている
- 透明性: 根拠と判断基準が文書化されている

## チェック手順

### 1. 文書存在・形式確認
```bash
ls docs-agent/implementation/
# 期待: components.md, schedule.md, directory-structure.md
```

### 2. 依存関係・構造図の確認
```bash
grep -n "```mermaid" docs-agent/workflows/step5-implementation-planning.md || true
```

### 3. トレーサビリティ確認
```markdown
# STEP4→STEP5 対応表（例）
| STEP4成果物 | STEP5計画項目 | 備考 |
|-------------|---------------|------|
| テスト対象一覧 | コンポーネント一覧 | 優先度整合 |
| 戦略/カバレッジ | 工程表/CI設定 | 閾値反映 |
```

### 4. 自動化準備確認
```bash
# カバレッジ閾値/スクリプトの確認
cat package.json | powershell -Command "$input | Select-String -Pattern 'test|coverage|lint|type-check'"
```

## 不合格時の対応

### 軽微（1-2日で修正可能）
- コンポーネント一覧の欠落補完、工程表の閾値反映、依存図の修正

### 重大（再計画が必要）
- リソース/スケジュールの非現実性、上流との不整合、CI未準備

## 合格判定

### 合格条件
- 全チェック項目が✅
- 定量的基準を全て満たす
- 実現可能性に重大リスクなし

### 合格時の次アクション
- STEP 7（コーディング実行）への移行承認
- 計画ベースライン確定（変更管理開始）

## 品質ゲート記録

### チェック実行記録
| 実行日 | チェック担当者 | 結果 | 指摘事項数 | 対応状況 |
|--------|----------------|------|------------|----------|
| 2025-01-28 | テックリード | 合格 | 0件 | 完了 |

