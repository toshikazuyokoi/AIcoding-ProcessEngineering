# docs-theory と docs-agent の統合是非に関する検討レポート（設計・評価・提案）

## 要旨（結論）
- 物理的な統合（フォルダ統合）は、現時点では推奨しない。まずは「ソフト統合（統合ポータル＋導線統一）」で混乱を解消し、必要性が残る場合にのみ段階的に物理統合を検討する。
- 理由：
  - 現状の分離（docs-theory=理論原典、人間向け大容量／docs-agent=再編運用、エージェント最適化小容量）は、エージェントのコンテキスト肥大・誤読を防ぐうえで合理的。
  - 混乱の主因は「入口と導線の不統一」。物理統合ではなくポータル化で大半が解決可能。
- 推奨方針：Phase 1（ソフト統合、低コスト・即効）→ 必要時 Phase 2（物理統合、強いガードレール前提）。

---

## 背景と課題
- 目的：プロセスエンジニアリング理論を、コンテキスト最適化（最小ルール＋オンデマンドWF）で実運用に落とし込む。
- 現状構造：
  - docs-theory/ … 理論の原典（人間向け、大容量、多章）
  - docs-agent/ … 再編運用（Core Rules, Workflows, Quality Gates, Meta Orchestrator, Context Protocol）
- 課題：
  - 人間の視点では「理論（docs-theory）」と「運用（docs-agent）」が分かれていて全体像が把握しづらい瞬間がある。
  - ワークフローから理論の該当節（docs-theory/theory/…）への参照があり、2ディレクトリ間の行き来が発生。

---

## 統合オプション（3案）

### 案1）ソフト統合（推奨）
- 何をするか：
  - 統合ポータル（Unified Portal）を1ページ用意。理論全体像→再編の目的→運用の最短手順→参照動線を集約。
  - 物理構造（docs-theory / docs-agent）は維持し、既存リンクを壊さない。
- 期待効果：
  - 認知負荷の低減（“どこから見れば良いか”が一目瞭然）。
  - エージェント誤読リスク（理論丸読み）を現状同等に低く維持。
  - 変更コストが極小。
- 留意点：
  - ポータル上に「Source Mappingによる最小抜粋」「理論丸読み禁止」のガイドを明示。

### 案2）物理統合（慎重）
- 何をするか：
  - 再編資産（現 docs-agent）を docs-theory/ 配下へ移動（例：docs-theory/agent/ または docs-theory/process/）。
  - 参照パス（AGENTS.md, .clinerules, docs-agent 内部の相互リンク等）を全面更新。
- メリット：
  - 「理論と運用が1フォルダ」の直観的構造。人間にとって把握が容易。
- デメリット・リスク：
  - 大規模なリンク改修が必要。導入コストとリスクが高い。
  - 多くのエージェントは README/docs を優先スキャンするため、理論（大容量）へ迷い込みやすい副作用が出る可能性。
- 必須ガードレール：
  - agent/配下の各文書先頭に「最小注入／theory丸読み禁止」を明記。
  - theory/側のREADMEにも「人間向け、エージェントはSource Mappingで必要最小抜粋のみ」と注意書き。
  - エージェント入口（AGENTS.md）はリポジトリ直下のまま固定。
  - 旧パスへの互換ラッパーを移行期間のみ設置。

### 案3）ハイブリッド（中間）
- 何をするか：
  - 物理構造は維持しつつ、docs-theory/README に「運用は docs-agent へ」、docs-agent/README に「理論は docs-theory/theory へ」の相互案内を強化。
  - 案1のポータルを追加し、実質的に“一体”に感じられる導線へ。

---

## 評価（観点別）
- 認知負荷（人間視点）
  - ソフト統合：高評価（ポータルで1画面の地図）
  - 物理統合：直観的だが、導入工数が大
- コンテキスト安全性（エージェント視点）
  - ソフト統合：最高（現状維持）
  - 物理統合：要ガードレール。設計次第で悪化余地
- 変更コスト／リスク
  - ソフト統合：小
  - 物理統合：大（全参照の置換・CIや外部自動化への影響）
- 将来拡張（モノレポ化、package追加）
  - いずれも対応可（AGENTS.mdの近接優先でローカル最適化が可能）

---

## 推奨方針とロードマップ

### Phase 1：ソフト統合（即時）
- 統合ポータルを作成（配置案いずれか）
  - A：リポジトリ直下 README に「人間向け上位案内」を追加
  - B：docs-theory/PORTAL.md（または docs-theory/README.md）として設置
- 章立て（目安）：
  1) 理論の全体像（STEP/品質ゲート/トレーサビリティ/再現性）
  2) 再編の目的（最小ルール＋JITワークフロー）
  3) 使い方の原則（最小注入、Source Mapping）
  4) 実務導線（AGENTS.md → docs-agent/core-rules → docs-agent/workflows → quality-gate）
  5) 理論参照の作法（該当節のみ最小抜粋）
  6) 代表ユースケース（要件→設計→ゲート→次STEP）
  7) 禁止事項・要承認境界（安全設計）
- リンク方針：
  - ポータル → AGENTS.md（エージェント入口）
  - ポータル → docs-agent/README（段階的ガイド）
  - workflows ↔ theory は Source Mapping で最小参照

### Phase 2：物理統合（必要性が残る場合のみ）
- 構造案：
  - docs-theory/
    - theory/（原典）
    - agent/（現 docs-agent 相当：core-rules / workflows / quality-gates / meta / protocol）
- 実施手順：
  1) 新構造で雛形作成、リンクチェッカーで全参照検証
  2) 旧パスに互換ラッパー（移行案内）を用意
  3) CI・PRテンプレ・自動化の参照更新
  4) 周知後、旧パス撤去
- 強いガードレール：
  - agent/ 冒頭注意書き、theory/ 側にも人間向け明記、AGENTS.md は直下で固定

---

## リスクと対策
- リスク：エージェントが理論丸読み → 対策：ポータル・AGENTS.md・agent/に最小注入を明記。
- リスク：リンク切れ → 対策：リンクチェッカー導入、移行期間の互換ラッパー。
- リスク：導入工数 → 対策：まずはソフト統合で効果確認。物理統合はROIを見極めたうえで。

---

## 次のアクション（修正はまだしない）
- 統合ポータルの配置方針の決定（ルートREADMEに追加 or docs-theory/PORTAL.md）。
- ポータルの章立て承認後、ドラフト作成。
- その後、必要に応じて物理統合の可否を再評価。

